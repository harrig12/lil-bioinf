---
title: "R for bioinformatics (and more!)"
draft: false
weight: 1
summary: "A gentle introduction in three parts."
output:
  blogdown::html_page:
    toc: true
    toc_depth: 2
---


<div id="TOC">
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#databases">2. Databases</a></li>
<li><a href="#drawing-data-driven-conclusions">3. Drawing data-driven conclusions</a></li>
</ul>
</div>

<div id="contents" class="section level2">
<h2>Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#r-basics">R basics</a></li>
<li><a href="#cran-and-bioconductor">CRAN and Bioconductor</a></li>
</ul></li>
<li><a href="#databases">Databases</a>
<ul>
<li><a href="#getting-data">Getting data</a></li>
<li><a href="#data-manipulation">Data manipulation</a></li>
<li><a href="#subsetting">Subsetting</a></li>
<li><a href="#data-exploration">Data exploration</a></li>
</ul></li>
<li><a href="#drawing-data-driven-conclusions">Drawing data-driven conclusions</a>
<ul>
<li><a href="#visualization">Visualization</a></li>
<li><a href="#statistical-testing">Statistical testing</a></li>
</ul></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<div id="r-basics" class="section level3">
<h3>1.1 R basics</h3>
<div id="rstudio-environment" class="section level4">
<h4>1.1.1 RStudio environment</h4>
<ul>
<li>panes</li>
<li>projects</li>
</ul>
</div>
<div id="variables" class="section level4">
<h4>1.1.2 Variables</h4>
</div>
<div id="comments" class="section level4">
<h4>1.1.3 Comments</h4>
</div>
<div id="vectors-and-lists" class="section level4">
<h4>1.1.4 Vectors and Lists</h4>
</div>
<div id="data-frames" class="section level4">
<h4>1.1.5 Data Frames</h4>
</div>
<div id="functions" class="section level4">
<h4>1.1.6 Functions</h4>
<ul>
<li><code>?</code> for help</li>
</ul>
</div>
<div id="plotting" class="section level4">
<h4>1.1.7 Plotting</h4>
</div>
<div id="scripts" class="section level4">
<h4>1.1.8 Scripts</h4>
</div>
</div>
<div id="cran-and-bioconductor" class="section level3">
<h3>1.2 CRAN and Bioconductor</h3>
<ul>
<li>types of packages available</li>
<li>anova, t-test, etc</li>
</ul>
</div>
</div>
<div id="databases" class="section level2">
<h2>2. Databases</h2>
<div id="getting-data" class="section level3">
<h3>2.1 Getting data</h3>
<div id="example-string-database" class="section level4">
<h4>2.1.1 Example: STRING database</h4>
</div>
</div>
<div id="data-manipulation" class="section level3">
<h3>2.2 Data manipulation</h3>
</div>
<div id="subsetting" class="section level3">
<h3>2.2.1 Subsetting</h3>
</div>
<div id="data-exploration" class="section level3">
<h3>2.2.2 Data exploration</h3>
</div>
</div>
<div id="drawing-data-driven-conclusions" class="section level2">
<h2>3. Drawing data-driven conclusions</h2>
<div id="visualization" class="section level3">
<h3>3.1 Visualization</h3>
<div id="set-up" class="section level4">
<h4>3.1.1 Set Up</h4>
<p>With the STRING data that we downloaded and previewed previously, we will create a network (aka. graph) representing protein interactions, and observe how certain proteins group together in “communities” with shared similarities.</p>
<pre class="r"><code># load an R package that will be useful for our task
if (!require(igraph)) {
  install.packages(&quot;igraph&quot;)
  library(igraph)
}</code></pre>
<pre><code>## Loading required package: igraph</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code># load data from STRING database, prepared in getData.R
load(&quot;./data/preparedData.RData&quot;)</code></pre>
</div>
<div id="define-functions" class="section level4">
<h4>3.1.2 Define functions</h4>
<p>We will define a few functions that let us do certain operations on the data.</p>
<pre class="r"><code>getGraphSize &lt;- function(G){
  # Find the difference in sizes between the largest 
  # and second largest communities in graph G
  # Parameters:
  #   G: an igraph
  #
  # Value: an integer
  
  # get cluster sizes
  sizes &lt;- sizes(cluster_infomap(G))
  
  # order sizes as a vector
  sizesOrdered &lt;- as.vector(sizes)
  
  # in some cases there is only one community
  if (length(sizesOrdered) == 1){
    # in this case, only return this community
    return(sizesOrdered[1])
  }
  
  # find difference between first and second largest community
  return(sizesOrdered[1] - sizesOrdered[2])
}

randGraph &lt;- function(G){
  # Make a random graph of same degree as an input igraph G
  # Parameters:
  #   G: an igraph
  #
  # Value: an undirected igraph with same degree as G
  
  d &lt;- degree(G)
  return(sample_degseq(d, method = &quot;vl&quot;))
}</code></pre>
</div>
<div id="plot-network" class="section level4">
<h4>3.1.3 Plot network</h4>
<p>This sections is modified from Boris Steipe’s <a href="https://github.com/hyginn/ABC-units">FND-MAT-Graphs_and_networks.R</a> Version 1.0</p>
<p>Create an igraph object from our STRING network, by plotting the network
according to community membership of each protein (represented as nodes)</p>
<p>An edge in our network is defined between a pair of proteins. For all the pairs
in our dataset, we want to create an edge. We select these as columns 1 and 2 of
our prepared dataset.</p>
<pre class="r"><code>stringNetwork &lt;- graph_from_edgelist(as.matrix(preparedData[c(1,2)]), directed = F)

# With functions from iGraph package, prepare network for plotting
communities &lt;- cluster_infomap(stringNetwork)
networkLayout &lt;- layout_with_graphopt(stringNetwork, charge = 0.002, mass=100, spring.constant = 0.5)

# Plot!
plot( stringNetwork,
      layout = networkLayout,
      rescale = F,
      xlim = c(min(networkLayout[,1]) * 0.99, max(networkLayout[,1]) * 1.01),
      ylim = c(min(networkLayout[,2]) * 0.99, max(networkLayout[,2]) * 1.01),
      vertex.color=rainbow(max(membership(communities)+1))[membership(communities)+1],
      vertex.size = 700 + (90 * degree(stringNetwork)),
      vertex.label = NA,
      main = &quot;Network from STRING data&quot;
    )</code></pre>
<p><img src="/lil-bioinf/post/workshop_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>With these settings, size of a node increases with degree, colour is dictated by
community membership. We can see that there are several fairly well connected nodes
with high degree of connectivity to other nodes. These nodes tend to be members of
larger communities - this makes sense biologically, we could expect a protein in a
large group of interacting proteins has many interactions. There are two distinctly
large and well connected communities.</p>
</div>
</div>
<div id="statistical-testing" class="section level3">
<h3>3.2 Statistical testing</h3>
</div>
</div>
