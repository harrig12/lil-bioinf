<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    
    <title>R for bioinformatics (and more!) | lil-bioinf</title>
    <meta name="description" content="Workshop - R for Bioinformatics">
    <meta name="author" content="">
    
    <link rel="shortcut icon" href="/images/lil-boi.png"/>
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">
    
    
    
    
    
    
    <link rel="authorization_endpoint" href="https://indieauth.com/auth">
    
    <link rel="stylesheet" href=https://harrig12.github.io/lil-bioinf/css/fonts.css />
    <link rel="stylesheet" href=https://harrig12.github.io/lil-bioinf/css/style.css />
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div id="sitelogo">
        <a class="glyph" alt="Home" href="https://harrig12.github.io/lil-bioinf/"><img src=https://harrig12.github.io/lil-bioinf/images/lil-boi.png alt="Site Logo" height="200px" width="64px"></a>
    </div>
    <header>
        <nav>
    
    <div id="page-nav">
        <div class="page-nav-item">
            <a href="https://harrig12.github.io/lil-bioinf/">Home</a>
        </div>
        
            <div class="page-nav-item">
                <a href="/lil-bioinf/about/">
                    
                    <span>About the workshop</span>
                </a>
            </div>
        
            <div class="page-nav-item">
                <a href="/lil-bioinf/dependencies/">
                    
                    <span>Instructions for installing required software</span>
                </a>
            </div>
        
    </div>
</nav>
        
    </header>
</body>



<div id="content">
    <article class="h-entry">
        <header>
            <h1 class="post-title p-name">R for bioinformatics (and more!)</h1>
            
            
            
        </header>
        <section class="content e-content">
            

<div id="TOC">
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#objects">Objects</a></li>
<li><a href="#numbers">Numbers</a></li>
<li><a href="#variables-1">Variables</a></li>
<li><a href="#data-structures">Data Structures</a></li>
<li><a href="#after-each-variable-assignment-write-down-what-you-think-youll-see">After each variable assignment, write down what you think you’ll see,</a></li>
<li><a href="#then-print-the-true-value">then print the true value</a></li>
<li><a href="#variables-2">Variables</a></li>
<li><a href="#numbers-1">Numbers</a></li>
<li><a href="#prediction-printa-will-show-1">Prediction: print(a) will show 1</a></li>
<li><a href="#strings-of-characters">Strings (of characters)</a></li>
<li><a href="#prediction">Prediction:</a></li>
<li><a href="#c-is-a-function-that-makes-a-vector">c() is a function that makes a vector</a></li>
<li><a href="#prediction-1">Prediction:</a></li>
<li><a href="#functions-1">Functions</a></li>
<li><a href="#c-is-a-function-and-it-returns-a-vector">c() is a function, and it returns a vector</a></li>
<li><a href="#we-can-use-the-mean-function-to-get-the-average-of-the-vector">we can use the mean() function to get the average of the vector</a></li>
<li><a href="#we-can-even-create-our-own-functions">we can even create our own functions</a></li>
<li><a href="#functions-also-have-documentation-that-is-accessible-by-using-or">functions also have documentation that is accessible by using ? or</a></li>
<li><a href="#the-help-funciton-help">the help funciton help()</a></li>
<li><a href="#more-types-of-objects">More types of objects</a></li>
<li><a href="#we-saw-numbers-and-strings">We saw numbers and strings</a></li>
<li><a href="#booleans">Booleans</a></li>
<li><a href="#vectors">Vectors</a></li>
<li><a href="#prediction-2">Prediction:</a></li>
<li><a href="#factors-for-categorical-variables">Factors (for categorical variables)</a></li>
<li><a href="#prediction-3">Prediction:</a></li>
<li><a href="#lists">Lists</a></li>
<li><a href="#prediction-4">Prediction:</a></li>
<li><a href="#prediction-5">Prediction:</a></li>
<li><a href="#prediction-6">Prediction:</a></li>
<li><a href="#prediction-7">Prediction:</a></li>
<li><a href="#dataframes">Dataframes</a></li>
<li><a href="#very-useful-for-storing-multiple-pieces-of-data-together.">Very useful for storing multiple pieces of data together.</a></li>
<li><a href="#we-want-shell-colour-as-a-categorical-variable">We want shell colour as a categorical variable</a></li>
<li><a href="#what-should-we-put-inside-the-as.factor-function-replace-the-string-below.">What should we put inside the as.factor() function? Replace the string below.</a></li>
<li><a href="#matrices-are-to-dataframes-as-lists-are-to-vectors.-similar-in-appearance-with">Matrices are to dataframes as lists are to vectors. Similar in appearance, with</a></li>
<li><a href="#some-usage-differences.-a-matrix-can-have-a-matrix-inside-it-in-the-way-that">some usage differences. A matrix can have a matrix inside it, in the way that</a></li>
<li><a href="#a-list-of-lists-is-possible.">a list of lists is possible.</a></li>
<li><a href="#cbind-is-for-column-bind-rbind-is-for-row-bind">cbind is for column bind, rbind is for row bind</a></li>
<li><a href="#accessing-data-indexing">accessing data (indexing)</a></li>
<li><a href="#data-can-be-accessed-out-of-datastructures-like-lists-vectors-dataframes-matricies">data can be accessed out of datastructures, like lists, vectors, dataframes, matricies</a></li>
<li><a href="#single-returns-an-object-of-the-same-type-double-may-returns-an-object-of-a-different-type.">single [] returns an object of the same type, double [[]] may returns an object of a different type.</a></li>
<li><a href="#we-can-keep-accessing-within-the-return-object">we can keep accessing within the return object</a></li>
<li><a href="#we-can-also-view-columns-of-the-dataframe-by-name.-can-index-with-or">We can also view columns of the dataframe by name. Can index with $ or [[]]</a></li>
<li><a href="#this-takes-a-little-practice-to-get-used-to-smart-indexing-and-subsetting">This takes a little practice to get used to! Smart indexing and subsetting</a></li>
<li><a href="#yield-elegant-solutions.">yield elegant solutions.</a></li>
<li><a href="#plotting-1">plotting</a></li>
<li><a href="#the-operator-lets-us-write-formulas.-this-is-great-for-plotting">the ~ operator lets us write formulas. This is great for plotting</a></li>
<li><a href="#and-we-can-add-extra-parameters-for-nice-looking-plots">and we can add extra parameters for nice looking plots</a></li>
<li><a href="#scripts-1">Scripts</a></li>
<li><a href="#up-until-now-this-.r-file-is-not-a-useful-script.-you-can-press-run-but-you">up until now, this .R file is not a useful script. You can press “run”, but you</a></li>
<li><a href="#wont-see-anything-happen.-this-isnt-because-nothings-happening-but-rather-the">won’t see anything happen. This isn’t because nothing’s happening, but rather the</a></li>
<li><a href="#results-are-not-being-output-to-somewhere-you-can-see.-to-fix-this-uncomment-the">results are not being output to somewhere you can see. To fix this, uncomment the</a></li>
<li><a href="#next-line-to-save-the-plot-to-an-image-file-and-try-running-it-again.">next line to save the plot to an image file, and try running it again.</a></li>
<li><a href="#there-are-two-resources-to-know-for-getting-the-most-out-of-r---cran-and-bioconductor.">there are two resources to know for getting the most out of R - CRAN and Bioconductor.</a></li>
<li><a href="#both-of-these-have-lots-of-different-packages-available-which-give-you-access">Both of these have lots of different packages available, which give you access</a></li>
<li><a href="#to-functionality-that-other-people-have-developed.-to-name-a-few">to functionality that other people have developed. To name a few…</a></li>
<li><a href="#ggplot2">ggplot2</a></li>
<li><a href="#dplyr">dplyr</a></li>
<li><a href="#bsgenome">BSgenome</a></li>
<li><a href="#biomart">biomaRt</a><ul>
<li><a href="#databases">2. Databases</a></li>
<li><a href="#drawing-data-driven-conclusions">3. Drawing data-driven conclusions</a></li>
</ul></li>
</ul>
</div>

<div id="contents" class="section level2">
<h2>Contents</h2>
<ul>
<li><a href="#objects">Objects</a></li>
<li><a href="#numbers">Numbers</a></li>
<li><a href="#variables">Variables</a></li>
<li><a href="#data-structures">Data Structures</a></li>
<li><a href="#after-each-variable-assignment,-write-down-what-you-think-you&#39;ll-see,">After each variable assignment, write down what you think you’ll see,</a></li>
<li><a href="#then-print-the-true-value">then print the true value</a></li>
<li><a href="#variables">Variables</a></li>
<li><a href="#numbers">Numbers</a></li>
<li><a href="#prediction:-print(a)-will-show-1">Prediction: print(a) will show 1</a></li>
<li><a href="#strings-(of-characters)">Strings (of characters)</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#c()-is-a-function-that-makes-a-vector">c() is a function that makes a vector</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#c()-is-a-function,-and-it-returns-a-vector">c() is a function, and it returns a vector</a></li>
<li><a href="#we-can-use-the-mean()-function-to-get-the-average-of-the-vector">we can use the mean() function to get the average of the vector</a></li>
<li><a href="#we-can-even-create-our-own-functions">we can even create our own functions</a></li>
<li><a href="#functions-also-have-documentation-that-is-accessible-by-using-?-or">functions also have documentation that is accessible by using ? or</a></li>
<li><a href="#the-help-funciton-help()">the help funciton help()</a></li>
<li><a href="#more-types-of-objects">More types of objects</a></li>
<li><a href="#we-saw-numbers-and-strings">We saw numbers and strings</a></li>
<li><a href="#booleans">Booleans</a></li>
<li><a href="#vectors">Vectors</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#factors-(for-categorical-variables)">Factors (for categorical variables)</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#lists">Lists</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#prediction:">Prediction:</a></li>
<li><a href="#dataframes">Dataframes</a></li>
<li><a href="#very-useful-for-storing-multiple-pieces-of-data-together.">Very useful for storing multiple pieces of data together.</a></li>
<li><a href="#we-want-shell-colour-as-a-categorical-variable">We want shell colour as a categorical variable</a></li>
<li><a href="#what-should-we-put-inside-the-as.factor()-function?-replace-the-string-below.">What should we put inside the as.factor() function? Replace the string below.</a></li>
<li><a href="#matrices-are-to-dataframes-as-lists-are-to-vectors.-similar-in-appearance,-with">Matrices are to dataframes as lists are to vectors. Similar in appearance, with</a></li>
<li><a href="#some-usage-differences.-a-matrix-can-have-a-matrix-inside-it,-in-the-way-that">some usage differences. A matrix can have a matrix inside it, in the way that</a></li>
<li><a href="#a-list-of-lists-is-possible.">a list of lists is possible.</a></li>
<li><a href="#cbind-is-for-column-bind,-rbind-is-for-row-bind">cbind is for column bind, rbind is for row bind</a></li>
<li><a href="#accessing-data-(indexing)">accessing data (indexing)</a></li>
<li><a href="#data-can-be-accessed-out-of-datastructures,-like-lists,-vectors,-dataframes,-matricies">data can be accessed out of datastructures, like lists, vectors, dataframes, matricies</a></li>
<li><a href="#single-%5B%5D-returns-an-object-of-the-same-type,-double-%5B%5B%5D%5D-may-returns-an-object-of-a-different-type.">single [] returns an object of the same type, double [[]] may returns an object of a different type.</a></li>
<li><a href="#we-can-keep-accessing-within-the-return-object">we can keep accessing within the return object</a></li>
<li><a href="#we-can-also-view-columns-of-the-dataframe-by-name.-can-index-with-$-or-%5B%5B%5D%5D">We can also view columns of the dataframe by name. Can index with $ or [[]]</a></li>
<li><a href="#this-takes-a-little-practice-to-get-used-to!-smart-indexing-and-subsetting">This takes a little practice to get used to! Smart indexing and subsetting</a></li>
<li><a href="#yield-elegant-solutions.">yield elegant solutions.</a></li>
<li><a href="#plotting">plotting</a></li>
<li><a href="#the-~-operator-lets-us-write-formulas.-this-is-great-for-plotting">the ~ operator lets us write formulas. This is great for plotting</a></li>
<li><a href="#and-we-can-add-extra-parameters-for-nice-looking-plots">and we can add extra parameters for nice looking plots</a></li>
<li><a href="#scripts">Scripts</a></li>
<li><a href="#up-until-now,-this-.r-file-is-not-a-useful-script.-you-can-press-%22run%22,-but-you">up until now, this .R file is not a useful script. You can press “run”, but you</a></li>
<li><a href="#won&#39;t-see-anything-happen.-this-isn&#39;t-because-nothing&#39;s-happening,-but-rather-the">won’t see anything happen. This isn’t because nothing’s happening, but rather the</a></li>
<li><a href="#results-are-not-being-output-to-somewhere-you-can-see.-to-fix-this,-uncomment-the">results are not being output to somewhere you can see. To fix this, uncomment the</a></li>
<li><a href="#next-line-to-save-the-plot-to-an-image-file,-and-try-running-it-again.">next line to save the plot to an image file, and try running it again.</a></li>
<li><a href="#there-are-two-resources-to-know-for-getting-the-most-out-of-r---cran-and-bioconductor.">there are two resources to know for getting the most out of R - CRAN and Bioconductor.</a></li>
<li><a href="#both-of-these-have-lots-of-different-packages-available,-which-give-you-access">Both of these have lots of different packages available, which give you access</a></li>
<li><a href="#to-functionality-that-other-people-have-developed.-to-name-a-few...">to functionality that other people have developed. To name a few…</a></li>
<li><a href="#ggplot2">ggplot2</a></li>
<li><a href="#dplyr">dplyr</a></li>
<li><a href="#bsgenome">BSgenome</a></li>
<li><a href="#biomart">biomaRt</a>
<ul>
<li><a href="#databases">Databases</a></li>
<li><a href="#drawing-data-driven-conclusions">Drawing data-driven conclusions</a></li>
</ul></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<div id="r-basics" class="section level3">
<h3>1.1 R basics</h3>
<div id="rstudio-environment" class="section level4">
<h4>1.1.1 RStudio environment</h4>
<ul>
<li>panes</li>
<li>projects</li>
</ul>
</div>
<div id="variables" class="section level4">
<h4>1.1.2 Variables</h4>
</div>
<div id="comments" class="section level4">
<h4>1.1.3 Comments</h4>
</div>
<div id="vectors-and-lists" class="section level4">
<h4>1.1.4 Vectors and Lists</h4>
</div>
<div id="data-frames" class="section level4">
<h4>1.1.5 Data Frames</h4>
</div>
<div id="functions" class="section level4">
<h4>1.1.6 Functions</h4>
<ul>
<li><code>?</code> for help</li>
</ul>
</div>
<div id="plotting" class="section level4">
<h4>1.1.7 Plotting</h4>
</div>
<div id="scripts" class="section level4">
<h4>1.1.8 Scripts</h4>
</div>
</div>
<div id="cran-and-bioconductor" class="section level3">
<h3>1.2 CRAN and Bioconductor</h3>
<ul>
<li>types of packages available</li>
<li>anova, t-test, etc</li>
</ul>
</div>
</div>
<div id="objects" class="section level1">
<h1>Objects</h1>
</div>
<div id="numbers" class="section level1">
<h1>Numbers</h1>
<p>(0.013 + 0.008 + 0.011) / 3</p>
</div>
<div id="variables-1" class="section level1">
<h1>Variables</h1>
<p>num_snails &lt;- 3</p>
<p>speed_snail1 &lt;- 0.013
speed_snail2 &lt;- 0.008
speed_snail3 &lt;- 0.011</p>
<p>(speed_snail1 + speed_snail2 + speed_snail3) / num_snails</p>
</div>
<div id="data-structures" class="section level1">
<h1>Data Structures</h1>
</div>
<div id="after-each-variable-assignment-write-down-what-you-think-youll-see" class="section level1">
<h1>After each variable assignment, write down what you think you’ll see,</h1>
</div>
<div id="then-print-the-true-value" class="section level1">
<h1>then print the true value</h1>
</div>
<div id="variables-2" class="section level1">
<h1>Variables</h1>
</div>
<div id="numbers-1" class="section level1">
<h1>Numbers</h1>
</div>
<div id="prediction-printa-will-show-1" class="section level1">
<h1>Prediction: print(a) will show 1</h1>
<p>a &lt;- 1
print(a)</p>
</div>
<div id="strings-of-characters" class="section level1">
<h1>Strings (of characters)</h1>
</div>
<div id="prediction" class="section level1">
<h1>Prediction:</h1>
<p>b &lt;- “my snail is the fastest!”
print(b)</p>
</div>
<div id="c-is-a-function-that-makes-a-vector" class="section level1">
<h1>c() is a function that makes a vector</h1>
</div>
<div id="prediction-1" class="section level1">
<h1>Prediction:</h1>
<p>snail_speeds &lt;- c(speed_snail1, speed_snail2, speed_snail3)
print(snail_speeds)</p>
</div>
<div id="functions-1" class="section level1">
<h1>Functions</h1>
</div>
<div id="c-is-a-function-and-it-returns-a-vector" class="section level1">
<h1>c() is a function, and it returns a vector</h1>
</div>
<div id="we-can-use-the-mean-function-to-get-the-average-of-the-vector" class="section level1">
<h1>we can use the mean() function to get the average of the vector</h1>
<p>mean(snail_speeds)</p>
</div>
<div id="we-can-even-create-our-own-functions" class="section level1">
<h1>we can even create our own functions</h1>
<p>fastest_snail &lt;- function(speeds){</p>
<p>snail_num &lt;- which(speeds == max(speeds))
message &lt;- sprintf(“The fastest is snail number %s”, snail_num)</p>
<p>return(message)
}</p>
<p>fastest_snail(snail_speeds)</p>
</div>
<div id="functions-also-have-documentation-that-is-accessible-by-using-or" class="section level1">
<h1>functions also have documentation that is accessible by using ? or</h1>
</div>
<div id="the-help-funciton-help" class="section level1">
<h1>the help funciton help()</h1>
<p>?mean
help(mean)</p>
</div>
<div id="more-types-of-objects" class="section level1">
<h1>More types of objects</h1>
</div>
<div id="we-saw-numbers-and-strings" class="section level1">
<h1>We saw numbers and strings</h1>
<p>print(a)
print(b)</p>
</div>
<div id="booleans" class="section level1">
<h1>Booleans</h1>
<p>print(TRUE == TRUE)
print(TRUE == FALSE)
print(TRUE != FALSE)
print(7 &lt; 8)</p>
</div>
<div id="vectors" class="section level1">
<h1>Vectors</h1>
</div>
<div id="prediction-2" class="section level1">
<h1>Prediction:</h1>
<p>c &lt;- 1:5
print(c)</p>
</div>
<div id="factors-for-categorical-variables" class="section level1">
<h1>Factors (for categorical variables)</h1>
</div>
<div id="prediction-3" class="section level1">
<h1>Prediction:</h1>
<p>shell_snail1 &lt;- factor(“brown”, levels = c(“brown”, “orange”))
print(shell_snail1)</p>
</div>
<div id="lists" class="section level1">
<h1>Lists</h1>
</div>
<div id="prediction-4" class="section level1">
<h1>Prediction:</h1>
<p>d &lt;- list(1,2,3,4,5)
print(d)</p>
</div>
<div id="prediction-5" class="section level1">
<h1>Prediction:</h1>
<p>e &lt;- list(b, “it came in”, a, “st place”)
print(e)</p>
</div>
<div id="prediction-6" class="section level1">
<h1>Prediction:</h1>
<p>f &lt;- unlist(e)
print(f)</p>
</div>
<div id="prediction-7" class="section level1">
<h1>Prediction:</h1>
<p>g &lt;- paste(f, collapse = " ")
print(g)</p>
</div>
<div id="dataframes" class="section level1">
<h1>Dataframes</h1>
</div>
<div id="very-useful-for-storing-multiple-pieces-of-data-together." class="section level1">
<h1>Very useful for storing multiple pieces of data together.</h1>
<p>print(snail_speeds)</p>
</div>
<div id="we-want-shell-colour-as-a-categorical-variable" class="section level1">
<h1>We want shell colour as a categorical variable</h1>
<p>shell_snail1 &lt;- “brown”
shell_snail2 &lt;- “orange”
shell_snail3 &lt;- “brown”</p>
<p>snail_shells &lt;- c(shell_snail1, shell_snail2, shell_snail3)</p>
</div>
<div id="what-should-we-put-inside-the-as.factor-function-replace-the-string-below." class="section level1">
<h1>What should we put inside the as.factor() function? Replace the string below.</h1>
<p>snail_shells_factor &lt;- as.factor(“replace this”)
print(snail_shells_factor)</p>
<p>snail_data &lt;- data.frame(speed = snail_speeds, shell_colour = snail_shells_factor)
print(snail_data)</p>
</div>
<div id="matrices-are-to-dataframes-as-lists-are-to-vectors.-similar-in-appearance-with" class="section level1">
<h1>Matrices are to dataframes as lists are to vectors. Similar in appearance, with</h1>
</div>
<div id="some-usage-differences.-a-matrix-can-have-a-matrix-inside-it-in-the-way-that" class="section level1">
<h1>some usage differences. A matrix can have a matrix inside it, in the way that</h1>
</div>
<div id="a-list-of-lists-is-possible." class="section level1">
<h1>a list of lists is possible.</h1>
</div>
<div id="cbind-is-for-column-bind-rbind-is-for-row-bind" class="section level1">
<h1>cbind is for column bind, rbind is for row bind</h1>
<p>h &lt;- cbind(snail_speeds, snail_shells)
print(h)</p>
</div>
<div id="accessing-data-indexing" class="section level1">
<h1>accessing data (indexing)</h1>
</div>
<div id="data-can-be-accessed-out-of-datastructures-like-lists-vectors-dataframes-matricies" class="section level1">
<h1>data can be accessed out of datastructures, like lists, vectors, dataframes, matricies</h1>
</div>
<div id="single-returns-an-object-of-the-same-type-double-may-returns-an-object-of-a-different-type." class="section level1">
<h1>single [] returns an object of the same type, double [[]] may returns an object of a different type.</h1>
<p>print(snail_data)
print(snail_data[1])
print(snail_data[[1]])</p>
</div>
<div id="we-can-keep-accessing-within-the-return-object" class="section level1">
<h1>we can keep accessing within the return object</h1>
<p>print(snail_data[[1]][2])</p>
</div>
<div id="we-can-also-view-columns-of-the-dataframe-by-name.-can-index-with-or" class="section level1">
<h1>We can also view columns of the dataframe by name. Can index with $ or [[]]</h1>
<p>print(snail_data$speed)
print(snail_data[[“speed”]])</p>
</div>
<div id="this-takes-a-little-practice-to-get-used-to-smart-indexing-and-subsetting" class="section level1">
<h1>This takes a little practice to get used to! Smart indexing and subsetting</h1>
</div>
<div id="yield-elegant-solutions." class="section level1">
<h1>yield elegant solutions.</h1>
</div>
<div id="plotting-1" class="section level1">
<h1>plotting</h1>
</div>
<div id="the-operator-lets-us-write-formulas.-this-is-great-for-plotting" class="section level1">
<h1>the ~ operator lets us write formulas. This is great for plotting</h1>
<p>group_averages &lt;- aggregate(speed ~ shell_colour, data = snail_data, FUN = mean)
barplot(group_averages$speed)</p>
</div>
<div id="and-we-can-add-extra-parameters-for-nice-looking-plots" class="section level1">
<h1>and we can add extra parameters for nice looking plots</h1>
<p>barplot(group_averages<span class="math inline">\(speed, col = levels(group_averages\)</span>shell_colour),
main = “Average snail speed”, ylab = “m/s”, names.arg = c(“brown shell”, “orange shell”))</p>
</div>
<div id="scripts-1" class="section level1">
<h1>Scripts</h1>
</div>
<div id="up-until-now-this-.r-file-is-not-a-useful-script.-you-can-press-run-but-you" class="section level1">
<h1>up until now, this .R file is not a useful script. You can press “run”, but you</h1>
</div>
<div id="wont-see-anything-happen.-this-isnt-because-nothings-happening-but-rather-the" class="section level1">
<h1>won’t see anything happen. This isn’t because nothing’s happening, but rather the</h1>
</div>
<div id="results-are-not-being-output-to-somewhere-you-can-see.-to-fix-this-uncomment-the" class="section level1">
<h1>results are not being output to somewhere you can see. To fix this, uncomment the</h1>
</div>
<div id="next-line-to-save-the-plot-to-an-image-file-and-try-running-it-again." class="section level1">
<h1>next line to save the plot to an image file, and try running it again.</h1>
<p>png()
barplot(group_averages<span class="math inline">\(speed, col = levels(group_averages\)</span>shell_colour),
main = “Average snail speed”, ylab = “m/s”, names.arg = c(“brown shell”, “orange shell”))
dev.off()</p>
</div>
<div id="there-are-two-resources-to-know-for-getting-the-most-out-of-r---cran-and-bioconductor." class="section level1">
<h1>there are two resources to know for getting the most out of R - CRAN and Bioconductor.</h1>
</div>
<div id="both-of-these-have-lots-of-different-packages-available-which-give-you-access" class="section level1">
<h1>Both of these have lots of different packages available, which give you access</h1>
</div>
<div id="to-functionality-that-other-people-have-developed.-to-name-a-few" class="section level1">
<h1>to functionality that other people have developed. To name a few…</h1>
</div>
<div id="ggplot2" class="section level1">
<h1>ggplot2</h1>
</div>
<div id="dplyr" class="section level1">
<h1>dplyr</h1>
</div>
<div id="bsgenome" class="section level1">
<h1>BSgenome</h1>
</div>
<div id="biomart" class="section level1">
<h1>biomaRt</h1>
<div id="databases" class="section level2">
<h2>2. Databases</h2>
<div id="getting-data" class="section level3">
<h3>2.1 Getting data</h3>
<div id="example-string-database" class="section level4">
<h4>2.1.1 Example: STRING database</h4>
</div>
</div>
<div id="data-manipulation" class="section level3">
<h3>2.2 Data manipulation</h3>
</div>
<div id="subsetting" class="section level3">
<h3>2.2.1 Subsetting</h3>
</div>
<div id="data-exploration" class="section level3">
<h3>2.2.2 Data exploration</h3>
</div>
</div>
<div id="drawing-data-driven-conclusions" class="section level2">
<h2>3. Drawing data-driven conclusions</h2>
<div id="visualization" class="section level3">
<h3>3.1 Visualization</h3>
<div id="set-up" class="section level4">
<h4>3.1.1 Set Up</h4>
<p>With the STRING data that we downloaded and previewed previously, we will create a network (aka. graph) representing protein interactions, and observe how certain proteins group together in “communities” with shared similarities.</p>
<pre class="r"><code># load an R package that will be useful for our task
if (!require(igraph)) {
  install.packages(&quot;igraph&quot;)
  library(igraph)
}</code></pre>
<pre><code>## Loading required package: igraph</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code># load data from STRING database, prepared in getData.R
load(&quot;./data/preparedData.RData&quot;)</code></pre>
</div>
<div id="define-functions" class="section level4">
<h4>3.1.2 Define functions</h4>
<p>We will define a few functions that let us do certain operations on the data.</p>
<pre class="r"><code>getGraphSize &lt;- function(G){
  # Find the difference in sizes between the largest 
  # and second largest communities in graph G
  # Parameters:
  #   G: an igraph
  #
  # Value: an integer
  
  # get cluster sizes
  sizes &lt;- sizes(cluster_infomap(G))
  
  # order sizes as a vector
  sizesOrdered &lt;- as.vector(sizes)
  
  # in some cases there is only one community
  if (length(sizesOrdered) == 1){
    # in this case, only return this community
    return(sizesOrdered[1])
  }
  
  # find difference between first and second largest community
  return(sizesOrdered[1] - sizesOrdered[2])
}

randGraph &lt;- function(G){
  # Make a random graph of same degree as an input igraph G
  # Parameters:
  #   G: an igraph
  #
  # Value: an undirected igraph with same degree as G
  
  d &lt;- degree(G)
  return(sample_degseq(d, method = &quot;vl&quot;))
}</code></pre>
</div>
<div id="plot-network" class="section level4">
<h4>3.1.3 Plot network</h4>
<p>This sections is modified from Boris Steipe’s <a href="https://github.com/hyginn/ABC-units">FND-MAT-Graphs_and_networks.R</a> Version 1.0</p>
<p>Create an igraph object from our STRING network, by plotting the network
according to community membership of each protein (represented as nodes)</p>
<p>An edge in our network is defined between a pair of proteins. For all the pairs
in our dataset, we want to create an edge. We select these as columns 1 and 2 of
our prepared dataset.</p>
<pre class="r"><code>stringNetwork &lt;- graph_from_edgelist(as.matrix(preparedData[c(1,2)]), directed = F)

# With functions from iGraph package, prepare network for plotting
communities &lt;- cluster_infomap(stringNetwork)
networkLayout &lt;- layout_with_graphopt(stringNetwork, charge = 0.002, mass=100, spring.constant = 0.5)

# Plot!
plot( stringNetwork,
      layout = networkLayout,
      rescale = F,
      xlim = c(min(networkLayout[,1]) * 0.99, max(networkLayout[,1]) * 1.01),
      ylim = c(min(networkLayout[,2]) * 0.99, max(networkLayout[,2]) * 1.01),
      vertex.color=rainbow(max(membership(communities)+1))[membership(communities)+1],
      vertex.size = 700 + (90 * degree(stringNetwork)),
      vertex.label = NA,
      main = &quot;Network from STRING data&quot;
    )</code></pre>
<p><img src="/lil-bioinf/post/workshop_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>With these settings, size of a node increases with degree, colour is dictated by
community membership. We can see that there are several fairly well connected nodes
with high degree of connectivity to other nodes. These nodes tend to be members of
larger communities - this makes sense biologically, we could expect a protein in a
large group of interacting proteins has many interactions. There are two distinctly
large and well connected communities.</p>
</div>
</div>
<div id="statistical-testing" class="section level3">
<h3>3.2 Statistical testing</h3>
</div>
</div>
</div>

        </section>
        <footer>
            <a class="permalink u-url" href="https://harrig12.github.io/lil-bioinf/post/workshop/"></a>
            
        </footer>
    </article>
</div>

    
    <div id="footer">
      
      <nav id="article-skip">
        <div class="next">
          
          <a alt="Newer article" href="https://harrig12.github.io/lil-bioinf/about/">&larr; Newer</a>
          
        </div>
        <div class="top">
          <a alt="Top of page" href="#">Top</a>
        </div>
        <div class="prev">
          
          <a alt="Older article" href="https://harrig12.github.io/lil-bioinf/dependencies/">Older &rarr;</a>
          
        </div>
      </nav>
      
      <aside id="social">
  <div id="social-icons">
    
    
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="GitHub profile" href="https://github.com/harrig12/lil-bioinf"><img src=https://harrig12.github.io/lil-bioinf/icons/github.svg height="24px" width="24px"></a>
    </div>
    
    
    
    
    
    
    
    
    
    
    
  </div>
</aside>

      
      <p class="copyright">
          Copyright © 2019, Gabriella Morgenshtern &amp; Cait Harrigan
      </p>
      
    </div>


</body>
</html>
